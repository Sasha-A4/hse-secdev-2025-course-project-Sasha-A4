# Non-Functional Requirements (Security & Performance)

| ID     | Название                           | Описание                                                                                     | Метрика / Порог                                  | Проверка (чем / где)                        | Компонент   | Приоритет  |
|--------|------------------------------------|----------------------------------------------------------------------------------------------|--------------------------------------------------|---------------------------------------------|-------------|------------|
| NFR-01 | Безопасное хранение паролей        | Все пароли хранятся только в виде хэшей Argon2id                                             | Argon2id, t=3, m=256MB, p=1                      | Unit-тест конфигурации, проверка модели     | auth        | High       |
| NFR-02 | Формат ошибок RFC7807              | Ошибки API не содержат PII, возвращаются в формате RFC7807                                   | 100% endpoint’ов                                 | Контрактные тесты + e2e                     | api         | Medium     |
| NFR-03 | Время ответа API                   | Время ответа p95 для `/features` ≤ 250 мс при 30 RPS                                         | p95 ≤ 250 мс                                     | k6 / Locust нагрузочный тест                | backend     | High       |
| NFR-04 | Устойчивость к нагрузке            | При росте до 100 RPS сервис сохраняет p99 < 400 мс и error rate < 1%                         | p99 ≤ 400 мс; err ≤ 1%                           | Нагрузочный тест                            | backend     | Medium     |
| NFR-05 | Уязвимости зависимостей            | High/Critical уязвимости устраняются ≤ 7 дней                                                | ≤ 7 дней                                         | CI: Dependabot + Snyk / Safety              | build       | High       |
| NFR-06 | Аудит логов                        | Все POST/PUT/DELETE операции логируются с user_id, временем и IP                             | 100% POST/PUT/DELETE                             | Интеграционные тесты логгера                | backend     | Medium     |
| NFR-07 | Ограничение частоты запросов       | Не более 10 RPS с IP, не более 100 RPS с пользователя                                        | 10 RPS / IP; 100 RPS / user                      | Rate limit middleware + интеграционный тест | gateway     | Medium     |
| NFR-08 | Ротация токенов JWT                | JWT сроком жизни ≤ 30 дней, обязательная ротация при refresh                                 | TTL ≤ 30 дней                                    | Unit-тест + тест конфигурации               | auth        | Medium     |
| NFR-09 | Доступность сервиса (SLA)          | Uptime ≥ 99.5% в месяц                                                                       | ≥ 99.5%                                          | Мониторинг + CI healthcheck                 | infra       | High       |
| NFR-10 | Защита от конфликтов данных        | При одновременных голосах за одну фичу данные не теряются                                    | 100% корректность голосов                        | Тест конкурентных запросов                  | backend     | Medium     |
